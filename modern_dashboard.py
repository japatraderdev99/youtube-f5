"""
Dashboard Moderno F5 - Interface Avan√ßada para Otimiza√ß√£o de Conte√∫do
Sistema sofisticado com UX intuitivo para transcri√ß√µes e busca de conte√∫dos

Desenvolvido para F5 Estrat√©gia
"""

import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime, timedelta
import json
import re
import os
from typing import Dict, List, Any, Optional
import asyncio
from pathlib import Path

# Imports locais
from content_optimizer import ContentOptimizer
from competitor_analyzer import CompetitorAnalyzer
from youtube_api_manager import initialize_youtube_system
from config import F5Config, AppConfig

# Configura√ß√£o da p√°gina
st.set_page_config(
    page_title="F5 Estrat√©gia - Dashboard Avan√ßado",
    page_icon="üöÄ",
    layout="wide",
    initial_sidebar_state="expanded"
)

# CSS customizado para UX moderno
def load_custom_css():
    st.markdown("""
    <style>
    /* Tema principal */
    :root {
        --primary-color: #FF6B35;
        --secondary-color: #004E89;
        --accent-color: #1A936F;
        --background-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --card-shadow: 0 8px 32px rgba(0,0,0,0.1);
        --border-radius: 16px;
    }
    
    /* Layout principal */
    .main-header {
        background: var(--background-gradient);
        padding: 2rem;
        border-radius: var(--border-radius);
        margin-bottom: 2rem;
        color: white;
        text-align: center;
        box-shadow: var(--card-shadow);
    }
    
    .main-header h1 {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .main-header p {
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 0;
    }
    
    /* Cards modernos */
    .modern-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 2rem;
        box-shadow: var(--card-shadow);
        border: 1px solid #e1e5e9;
        margin-bottom: 1.5rem;
        transition: all 0.3s ease;
    }
    
    .modern-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }
    
    /* Bot√µes estilizados */
    .stButton > button {
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 12px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255,107,53,0.3);
    }
    
    .stButton > button:hover {
        background: #e55a2b;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255,107,53,0.4);
    }
    
    /* Input fields */
    .stTextInput > div > div > input,
    .stTextArea > div > div > textarea {
        border-radius: 12px;
        border: 2px solid #e1e5e9;
        transition: all 0.3s ease;
    }
    
    .stTextInput > div > div > input:focus,
    .stTextArea > div > div > textarea:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(255,107,53,0.1);
    }
    
    /* Sidebar moderna */
    .css-1d391kg {
        background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    }
    
    /* M√©tricas KPI */
    .metric-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: 1px solid #e1e5e9;
        margin: 0.5rem 0;
    }
    
    .metric-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
    }
    
    .metric-label {
        font-size: 0.9rem;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    /* Drag and drop area */
    .upload-area {
        border: 3px dashed var(--primary-color);
        border-radius: var(--border-radius);
        padding: 3rem;
        text-align: center;
        background: linear-gradient(45deg, rgba(255,107,53,0.05), rgba(0,78,137,0.05));
        margin: 2rem 0;
        transition: all 0.3s ease;
    }
    
    .upload-area:hover {
        background: linear-gradient(45deg, rgba(255,107,53,0.1), rgba(0,78,137,0.1));
        transform: scale(1.02);
    }
    
    /* Status indicators */
    .status-success {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 25px;
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    .status-processing {
        background: linear-gradient(135deg, #ffc107, #fd7e14);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 25px;
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    /* Anima√ß√µes */
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.7; }
        100% { opacity: 1; }
    }
    
    .pulse {
        animation: pulse 2s infinite;
    }
    
    /* Responsividade */
    @media (max-width: 768px) {
        .main-header h1 {
            font-size: 2rem;
        }
        
        .modern-card {
            padding: 1rem;
        }
    }
    </style>
    """, unsafe_allow_html=True)

# Classes auxiliares
class TranscriptionProcessor:
    """Processador avan√ßado de transcri√ß√µes"""
    
    def __init__(self):
        self.content_optimizer = ContentOptimizer()
    
    def extract_key_insights(self, transcription: str) -> Dict[str, Any]:
        """Extrai insights principais da transcri√ß√£o"""
        insights = {
            'word_count': len(transcription.split()),
            'estimated_duration': len(transcription.split()) / 150,  # ~150 palavras/minuto
            'key_topics': self._extract_topics(transcription),
            'sentiment_analysis': self._analyze_sentiment(transcription),
            'call_to_actions': self._find_ctas(transcription),
            'technical_terms': self._find_technical_terms(transcription)
        }
        return insights
    
    def _extract_topics(self, text: str) -> List[str]:
        """Extrai t√≥picos principais usando palavras-chave"""
        marketing_keywords = [
            'marketing digital', 'tr√°fego pago', 'seo', 'convers√£o', 
            'roi', 'leads', 'funil', 'vendas', 'crm', 'analytics'
        ]
        
        found_topics = []
        text_lower = text.lower()
        
        for keyword in marketing_keywords:
            if keyword in text_lower:
                found_topics.append(keyword)
        
        return found_topics[:5]  # Top 5 t√≥picos
    
    def _analyze_sentiment(self, text: str) -> str:
        """An√°lise b√°sica de sentimento"""
        positive_words = ['sucesso', 'crescimento', 'resultado', 'excelente', '√≥timo']
        negative_words = ['problema', 'dificuldade', 'erro', 'falha', 'ruim']
        
        positive_count = sum(1 for word in positive_words if word in text.lower())
        negative_count = sum(1 for word in negative_words if word in text.lower())
        
        if positive_count > negative_count:
            return "Positivo"
        elif negative_count > positive_count:
            return "Negativo"
        else:
            return "Neutro"
    
    def _find_ctas(self, text: str) -> List[str]:
        """Encontra chamadas para a√ß√£o no texto"""
        cta_patterns = [
            r'inscreva[-\s]?se',
            r'clique\s+aqui',
            r'acesse\s+o\s+link',
            r'baixe\s+(?:o|a)',
            r'entre\s+em\s+contato',
            r'agende\s+(?:uma|um)',
        ]
        
        found_ctas = []
        for pattern in cta_patterns:
            matches = re.findall(pattern, text, re.IGNORECASE)
            found_ctas.extend(matches)
        
        return list(set(found_ctas))  # Remove duplicatas
    
    def _find_technical_terms(self, text: str) -> List[str]:
        """Encontra termos t√©cnicos relevantes"""
        tech_terms = [
            'pixel', 'utm', 'api', 'dashboard', 'kpi', 'roi', 'roas',
            'ctr', 'cpc', 'cpm', 'lookalike', 'retargeting', 'remarketing'
        ]
        
        found_terms = []
        text_lower = text.lower()
        
        for term in tech_terms:
            if term in text_lower:
                found_terms.append(term.upper())
        
        return found_terms

class ContentSearchEngine:
    """Motor de busca avan√ßado para conte√∫dos"""
    
    def __init__(self):
        self.content_database = self._load_content_database()
    
    def _load_content_database(self) -> List[Dict[str, Any]]:
        """Carrega banco de dados de conte√∫dos"""
        # Simula√ß√£o de banco de dados - em produ√ß√£o seria conectado a uma API
        return [
            {
                'title': 'Como estruturar funil de vendas que converte',
                'category': 'Funil de Vendas',
                'persona': 'crescimento',
                'keywords': ['funil', 'vendas', 'convers√£o', 'estrutura'],
                'performance_score': 8.5,
                'views': 15420,
                'engagement_rate': 4.2
            },
            {
                'title': 'ROI em tr√°fego pago: M√©tricas que importam',
                'category': 'Tr√°fego Pago',
                'persona': 'estrategico',
                'keywords': ['roi', 'tr√°fego pago', 'm√©tricas', 'an√°lise'],
                'performance_score': 9.1,
                'views': 23650,
                'engagement_rate': 5.8
            },
            {
                'title': 'Gera√ß√£o de leads: 5 estrat√©gias pr√°ticas',
                'category': 'Lead Generation',
                'persona': 'smart',
                'keywords': ['leads', 'gera√ß√£o', 'estrat√©gias', 'pr√°tico'],
                'performance_score': 7.9,
                'views': 18330,
                'engagement_rate': 3.9
            }
        ]
    
    def search_content(self, query: str, filters: Dict[str, Any] = None) -> List[Dict[str, Any]]:
        """Busca conte√∫dos baseado em query e filtros"""
        results = []
        query_lower = query.lower()
        
        for content in self.content_database:
            # Calcular score de relev√¢ncia
            relevance_score = 0
            
            # Busca no t√≠tulo
            if query_lower in content['title'].lower():
                relevance_score += 3
            
            # Busca nas keywords
            for keyword in content['keywords']:
                if query_lower in keyword.lower():
                    relevance_score += 2
            
            # Busca na categoria
            if query_lower in content['category'].lower():
                relevance_score += 1
            
            # Aplicar filtros se fornecidos
            if filters:
                if 'persona' in filters and filters['persona'] != content['persona']:
                    continue
                if 'min_score' in filters and content['performance_score'] < filters['min_score']:
                    continue
            
            if relevance_score > 0:
                content_copy = content.copy()
                content_copy['relevance_score'] = relevance_score
                results.append(content_copy)
        
        # Ordenar por relev√¢ncia
        results.sort(key=lambda x: x['relevance_score'], reverse=True)
        return results
    
    def get_trending_topics(self) -> List[Dict[str, Any]]:
        """Retorna t√≥picos em tend√™ncia"""
        return [
            {'topic': 'IA no Marketing', 'growth': '+150%', 'searches': 45200},
            {'topic': 'Attribution Models', 'growth': '+89%', 'searches': 23100},
            {'topic': 'First-Party Data', 'growth': '+67%', 'searches': 34500},
            {'topic': 'Marketing Automation', 'growth': '+45%', 'searches': 67800},
            {'topic': 'Customer Journey', 'growth': '+23%', 'searches': 56700}
        ]

# Fun√ß√µes principais da interface
def render_header():
    """Renderiza cabe√ßalho principal"""
    st.markdown("""
    <div class="main-header">
        <h1>üöÄ F5 Estrat√©gia</h1>
        <p>Dashboard Avan√ßado para Otimiza√ß√£o de Conte√∫do YouTube</p>
    </div>
    """, unsafe_allow_html=True)

def render_sidebar():
    """Renderiza sidebar com navega√ß√£o"""
    with st.sidebar:
        st.markdown("## üéØ Navega√ß√£o")
        
        page = st.selectbox(
            "Escolha uma se√ß√£o:",
            [
                "üìù Inserir Transcri√ß√£o",
                "üîç Buscar Conte√∫dos", 
                "üìä Analytics Avan√ßado",
                "üèÜ An√°lise Competitiva",
                "üí° Sugest√µes IA",
                "‚öôÔ∏è Configura√ß√µes"
            ]
        )
        
        st.markdown("---")
        
        # Status do sistema
        st.markdown("### üì° Status do Sistema")
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown('<div class="status-success">üü¢ Online</div>', unsafe_allow_html=True)
        
        with col2:
            st.markdown('<div class="status-processing">‚ö° IA Ativa</div>', unsafe_allow_html=True)
        
        st.markdown("---")
        
        # M√©tricas r√°pidas
        st.markdown("### üìà M√©tricas R√°pidas")
        
        st.markdown("""
        <div class="metric-card">
            <div class="metric-value">8.7</div>
            <div class="metric-label">Score SEO M√©dio</div>
        </div>
        """, unsafe_allow_html=True)
        
        st.markdown("""
        <div class="metric-card">
            <div class="metric-value">156</div>
            <div class="metric-label">V√≠deos Analisados</div>
        </div>
        """, unsafe_allow_html=True)
        
        st.markdown("""
        <div class="metric-card">
            <div class="metric-value">+23%</div>
            <div class="metric-label">Crescimento Mensal</div>
        </div>
        """, unsafe_allow_html=True)
    
    return page

def page_transcription_input():
    """P√°gina para inser√ß√£o de transcri√ß√µes"""
    st.markdown("## üìù An√°lise de Transcri√ß√£o de V√≠deo")
    st.markdown("Insira a transcri√ß√£o do seu v√≠deo para an√°lise inteligente e otimiza√ß√£o autom√°tica.")
    
    # Container principal
    with st.container():
        col1, col2 = st.columns([2, 1])
        
        with col1:
            st.markdown('<div class="modern-card">', unsafe_allow_html=True)
            
            # M√©todo de input
            input_method = st.radio(
                "Como voc√™ quer inserir a transcri√ß√£o?",
                ["üìù Digitar/Colar texto", "üìÅ Upload de arquivo", "üé§ √Åudio para texto (em breve)"],
                horizontal=True
            )
            
            transcription_text = ""
            
            if input_method == "üìù Digitar/Colar texto":
                transcription_text = st.text_area(
                    "Cole ou digite a transcri√ß√£o aqui:",
                    height=300,
                    placeholder="Cole aqui a transcri√ß√£o do seu v√≠deo...\n\nEx: Ol√° pessoal, bem-vindos ao canal! Hoje vamos falar sobre estrat√©gias de marketing digital que realmente funcionam..."
                )
            
            elif input_method == "üìÅ Upload de arquivo":
                uploaded_file = st.file_uploader(
                    "Fa√ßa upload de um arquivo de texto",
                    type=['txt', 'docx', 'pdf']
                )
                
                if uploaded_file is not None:
                    if uploaded_file.type == "text/plain":
                        transcription_text = str(uploaded_file.read(), "utf-8")
                        st.success("‚úÖ Arquivo carregado com sucesso!")
            
            # Informa√ß√µes do v√≠deo
            st.markdown("### üìã Informa√ß√µes do V√≠deo (Opcional)")
            
            col_a, col_b = st.columns(2)
            
            with col_a:
                video_title = st.text_input("T√≠tulo do v√≠deo:")
                video_category = st.selectbox(
                    "Categoria:",
                    ["Marketing Digital", "Tr√°fego Pago", "Vendas", "Estrat√©gia", "Analytics", "Outros"]
                )
            
            with col_b:
                target_persona = st.selectbox(
                    "Persona alvo:",
                    ["estrategico", "crescimento", "smart"]
                )
                video_duration = st.number_input("Dura√ß√£o estimada (min):", min_value=1, max_value=120, value=10)
            
            st.markdown('</div>', unsafe_allow_html=True)
        
        with col2:
            st.markdown('<div class="modern-card">', unsafe_allow_html=True)
            st.markdown("### üéØ An√°lise R√°pida")
            
            if transcription_text:
                processor = TranscriptionProcessor()
                insights = processor.extract_key_insights(transcription_text)
                
                # M√©tricas b√°sicas
                st.metric("Palavras", f"{insights['word_count']:,}")
                st.metric("Dura√ß√£o estimada", f"{insights['estimated_duration']:.1f} min")
                st.metric("Sentimento", insights['sentiment_analysis'])
                
                # T√≥picos encontrados
                if insights['key_topics']:
                    st.markdown("**üè∑Ô∏è T√≥picos identificados:**")
                    for topic in insights['key_topics']:
                        st.markdown(f"‚Ä¢ {topic}")
                
                # CTAs encontrados
                if insights['call_to_actions']:
                    st.markdown("**üì¢ CTAs encontrados:**")
                    for cta in insights['call_to_actions']:
                        st.markdown(f"‚Ä¢ {cta}")
            
            else:
                st.info("üëÜ Insira uma transcri√ß√£o para ver a an√°lise")
            
            st.markdown('</div>', unsafe_allow_html=True)
    
    # Bot√£o de an√°lise principal
    if st.button("üöÄ Analisar e Otimizar Conte√∫do", type="primary", use_container_width=True):
        if transcription_text:
            with st.spinner("ü§ñ Analisando transcri√ß√£o com IA..."):
                # Simular processamento
                import time
                time.sleep(2)
                
                # Exibir resultados
                render_optimization_results(transcription_text, video_title, target_persona)
        else:
            st.error("‚ùå Por favor, insira uma transcri√ß√£o antes de continuar.")

def render_optimization_results(transcription: str, title: str, persona: str):
    """Renderiza resultados da otimiza√ß√£o"""
    st.markdown("---")
    st.markdown("## üéØ Resultados da Otimiza√ß√£o")
    
    # Tabs para diferentes resultados
    tab1, tab2, tab3, tab4 = st.tabs(["üìä Score SEO", "üìù Sugest√µes de Melhoria", "üè∑Ô∏è Tags Otimizadas", "üìà Proje√ß√£o de Performance"])
    
    with tab1:
        col1, col2, col3 = st.columns(3)
        
        with col1:
            st.markdown("""
            <div class="metric-card">
                <div class="metric-value">8.5</div>
                <div class="metric-label">Score SEO Geral</div>
            </div>
            """, unsafe_allow_html=True)
        
        with col2:
            st.markdown("""
            <div class="metric-card">
                <div class="metric-value">92%</div>
                <div class="metric-label">Adequa√ß√£o √† Persona</div>
            </div>
            """, unsafe_allow_html=True)
        
        with col3:
            st.markdown("""
            <div class="metric-card">
                <div class="metric-value">7.2</div>
                <div class="metric-label">Potencial de Engajamento</div>
            </div>
            """, unsafe_allow_html=True)
        
        # Gr√°fico radar de an√°lise
        categories = ['SEO', 'Engajamento', 'Clareza', 'CTA', 'Persona Fit']
        scores = [8.5, 7.2, 9.1, 6.8, 9.2]
        
        fig = go.Figure()
        fig.add_trace(go.Scatterpolar(
            r=scores,
            theta=categories,
            fill='toself',
            name='Score Atual',
            line_color='#FF6B35'
        ))
        
        fig.update_layout(
            polar=dict(
                radialaxis=dict(
                    visible=True,
                    range=[0, 10]
                )),
            showlegend=False,
            title="An√°lise Multidimensional do Conte√∫do"
        )
        
        st.plotly_chart(fig, use_container_width=True)
    
    with tab2:
        st.markdown("### üí° Sugest√µes de Melhoria")
        
        suggestions = [
            {
                'priority': 'Alta',
                'category': 'SEO',
                'suggestion': 'Adicionar palavra-chave principal no primeiro par√°grafo',
                'impact': '+15% reach org√¢nico'
            },
            {
                'priority': 'M√©dia',
                'category': 'Engajamento',
                'suggestion': 'Incluir pergunta interativa aos 2:30min',
                'impact': '+8% retention'
            },
            {
                'priority': 'Alta',
                'category': 'CTA',
                'suggestion': 'Refor√ßar call-to-action no final do v√≠deo',
                'impact': '+22% convers√£o'
            }
        ]
        
        for sugg in suggestions:
            priority_color = "üî¥" if sugg['priority'] == 'Alta' else "üü°"
            st.markdown(f"""
            <div class="modern-card">
                <strong>{priority_color} {sugg['priority']} - {sugg['category']}</strong><br>
                {sugg['suggestion']}<br>
                <small style="color: #28a745;">üìà Impacto esperado: {sugg['impact']}</small>
            </div>
            """, unsafe_allow_html=True)
    
    with tab3:
        st.markdown("### üè∑Ô∏è Tags Otimizadas")
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown("**Tags Atuais:**")
            current_tags = ["marketing digital", "vendas", "estrat√©gia"]
            for tag in current_tags:
                st.markdown(f"‚Ä¢ {tag}")
        
        with col2:
            st.markdown("**Tags Sugeridas pela IA:**")
            suggested_tags = [
                "funil de vendas", "convers√£o", "roi marketing", 
                "tr√°fego pago", "lead generation", "crm vendas"
            ]
            for tag in suggested_tags:
                st.markdown(f"‚Ä¢ {tag} ‚≠ê")
    
    with tab4:
        st.markdown("### üìà Proje√ß√£o de Performance")
        
        # Gr√°fico de proje√ß√£o
        data = {
            'M√©trica': ['Views', 'Curtidas', 'Coment√°rios', 'Compartilhamentos', 'Inscritos'],
            'Atual': [1200, 85, 12, 8, 15],
            'Proje√ß√£o Otimizada': [1800, 140, 22, 18, 28]
        }
        
        df = pd.DataFrame(data)
        
        fig = px.bar(df, x='M√©trica', y=['Atual', 'Proje√ß√£o Otimizada'], 
                     title="Compara√ß√£o: Performance Atual vs Otimizada",
                     barmode='group')
        
        st.plotly_chart(fig, use_container_width=True)

def page_content_search():
    """P√°gina de busca de conte√∫dos"""
    st.markdown("## üîç Busca Inteligente de Conte√∫dos")
    st.markdown("Encontre conte√∫dos relevantes e analise tend√™ncias de mercado.")
    
    # Container de busca
    with st.container():
        col1, col2 = st.columns([3, 1])
        
        with col1:
            search_query = st.text_input(
                "üîé Digite sua busca:",
                placeholder="Ex: funil de vendas, roi tr√°fego pago, estrat√©gias de marketing..."
            )
        
        with col2:
            search_button = st.button("Buscar", type="primary", use_container_width=True)
    
    # Filtros avan√ßados
    with st.expander("üéõÔ∏è Filtros Avan√ßados"):
        col1, col2, col3 = st.columns(3)
        
        with col1:
            persona_filter = st.selectbox("Persona:", ["Todas", "estrategico", "crescimento", "smart"])
        
        with col2:
            min_score = st.slider("Score m√≠nimo:", 0.0, 10.0, 7.0)
        
        with col3:
            category_filter = st.selectbox("Categoria:", ["Todas", "Funil de Vendas", "Tr√°fego Pago", "Lead Generation"])
    
    # Exibir resultados
    if search_query or search_button:
        search_engine = ContentSearchEngine()
        
        filters = {}
        if persona_filter != "Todas":
            filters['persona'] = persona_filter
        if min_score > 0:
            filters['min_score'] = min_score
        
        results = search_engine.search_content(search_query, filters)
        
        if results:
            st.markdown(f"### üìã Resultados ({len(results)} encontrados)")
            
            for result in results:
                with st.container():
                    st.markdown('<div class="modern-card">', unsafe_allow_html=True)
                    
                    col1, col2 = st.columns([3, 1])
                    
                    with col1:
                        st.markdown(f"**{result['title']}**")
                        st.markdown(f"üìÇ {result['category']} | üë§ {result['persona']}")
                        st.markdown(f"üè∑Ô∏è {', '.join(result['keywords'])}")
                    
                    with col2:
                        st.metric("Score", f"{result['performance_score']}/10")
                        st.metric("Views", f"{result['views']:,}")
                        st.metric("Engagement", f"{result['engagement_rate']}%")
                    
                    if st.button(f"Ver detalhes", key=f"detail_{result['title'][:20]}"):
                        st.info("üîú Detalhes completos em breve...")
                    
                    st.markdown('</div>', unsafe_allow_html=True)
        else:
            st.info("üîç Nenhum resultado encontrado. Tente termos diferentes.")
    
    # Trending topics
    st.markdown("---")
    st.markdown("### üî• T√≥picos em Alta")
    
    search_engine = ContentSearchEngine()
    trending = search_engine.get_trending_topics()
    
    cols = st.columns(len(trending))
    
    for i, topic in enumerate(trending):
        with cols[i]:
            st.markdown(f"""
            <div class="metric-card">
                <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">
                    {topic['topic']}
                </div>
                <div class="metric-value" style="font-size: 1.5rem;">
                    {topic['growth']}
                </div>
                <div class="metric-label">
                    {topic['searches']:,} buscas
                </div>
            </div>
            """, unsafe_allow_html=True)

# Fun√ß√£o principal
def main():
    """Fun√ß√£o principal do dashboard"""
    load_custom_css()
    render_header()
    
    # Navega√ß√£o
    current_page = render_sidebar()
    
    # Renderizar p√°gina selecionada
    if current_page == "üìù Inserir Transcri√ß√£o":
        page_transcription_input()
    elif current_page == "üîç Buscar Conte√∫dos":
        page_content_search()
    elif current_page == "üìä Analytics Avan√ßado":
        st.markdown("## üìä Analytics Avan√ßado")
        st.info("üîú Se√ß√£o em desenvolvimento - Integrando com YouTube Analytics API...")
    elif current_page == "üèÜ An√°lise Competitiva":
        st.markdown("## üèÜ An√°lise Competitiva")
        st.info("üîú Se√ß√£o em desenvolvimento - Sistema de an√°lise de concorrentes...")
    elif current_page == "üí° Sugest√µes IA":
        st.markdown("## üí° Sugest√µes de Conte√∫do com IA")
        st.info("üîú Se√ß√£o em desenvolvimento - Gerador de ideias baseado em CHAVI...")
    else:  # Configura√ß√µes
        st.markdown("## ‚öôÔ∏è Configura√ß√µes")
        st.info("üîú Se√ß√£o em desenvolvimento - Configura√ß√µes do sistema...")
    
    # Footer
    st.markdown("---")
    st.markdown("""
    <div style="text-align: center; color: #6c757d; padding: 1rem;">
        üöÄ <strong>F5 Estrat√©gia</strong> - Sistema de Otimiza√ß√£o YouTube com IA<br>
        <small>Desenvolvido com ‚ù§Ô∏è para maximizar resultados no YouTube</small>
    </div>
    """, unsafe_allow_html=True)

if __name__ == "__main__":
    main() 